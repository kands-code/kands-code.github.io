<!DOCTYPE HTML>
<html
    lang="zh-Hans" 
    class="rust" 
    dir="ltr"> 
    <head>
        <title>Rust å­¦ä¹  05 - Kevin Stephen&#x27;s Blogs</title> 
        <meta charset="UTF-8">
        <meta name="description" content="æ‰¾åˆ°å±äºè‡ªå·±çš„å…‰">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">
        
         
        <link rel="icon" href="../../favicon.svg">
         
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <link rel="stylesheet"
            href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <link rel="stylesheet" href="../../theme/utils.css">

    </head>
    <body class="sidebar-visible no-js">
        <div id="body-container">
            <script>
                // è·å– root è·¯å¾„
                var path_to_root = "../../";
                // è·å–é»˜è®¤ä¸»é¢˜
                var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches
                    ? "ayu"
                    : "rust";
            </script>
            <script>
                try {
                    var theme = localStorage.getItem("mdbook-theme");
                    var sidebar = localStorage.getItem("mdbook-sidebar");

                    if (theme.startsWith('"') && theme.endsWith('"')) {
                        localStorage.setItem(
                            "mdbook-theme",
                            theme.slice(1, theme.length - 1).trim()
                        );
                    }

                    if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                        localStorage.setItem(
                            "mdbook-sidebar",
                            sidebar.slice(1, sidebar.length - 1).trim()
                        );
                    }
                } catch (e) {}
            </script>
            <script>
                var theme;
                try {
                    theme = localStorage.getItem("mdbook-theme");
                } catch (e) {}
                if (theme === null || theme === undefined) {
                    theme = default_theme;
                }
                var html = document.querySelector("html");
                html.classList.remove("rust");
                html.classList.add(theme);
                var body = document.querySelector("body");
                body.classList.remove("no-js");
                body.classList.add("js");
            </script>

            <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">
            <script>
                var body = document.querySelector("body");
                var sidebar = null;
                var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
                if (document.body.clientWidth >= 1080) {
                try {
                    sidebar = localStorage.getItem("mdbook-sidebar");
                } catch (e) {}
                    sidebar = sidebar || "visible";
                } else {
                    sidebar = "hidden";
                }
                sidebar_toggle.checked = sidebar === "visible";
                body.classList.remove("sidebar-visible");
                body.classList.add("sidebar-" + sidebar);
            </script>

            <nav id="sidebar" class="sidebar" aria-label="Table of contents">
                <div class="sidebar-scrollbox">
                    <ol class="chapter"><li class="chapter-item "><a href="../../init.html">Init</a></li><li class="chapter-item "><a href="../../about.html">About</a></li><li class="chapter-item affix "><li class="part-title">Notes</li><li class="chapter-item expanded "><a href="../../notes/rust/index.html">Rust</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/rust/20210605-rust-learn-01.html">Rust å­¦ä¹  01</a></li><li class="chapter-item "><a href="../../notes/rust/20210610-rust-learn-02.html">Rust å­¦ä¹  02</a></li><li class="chapter-item "><a href="../../notes/rust/20210824-rust-learn-03.html">Rust å­¦ä¹  03</a></li><li class="chapter-item "><a href="../../notes/rust/20211216-rust-learn-04.html">Rust å­¦ä¹  04</a></li><li class="chapter-item expanded "><a href="../../notes/rust/20220512-rust-learn-05.html" class="active">Rust å­¦ä¹  05</a></li><li class="chapter-item "><a href="../../notes/rust/20220514-rust-learn-06.html">Rust å­¦ä¹  06</a></li><li class="chapter-item "><a href="../../notes/rust/20220520-rust-learn-07.html">Rust å­¦ä¹  07</a></li><li class="chapter-item "><a href="../../notes/rust/20220522-rust-learn-08.html">Rust å­¦ä¹  08</a></li><li class="chapter-item "><a href="../../notes/rust/20220523-rust-learn-09.html">Rust å­¦ä¹  09</a></li><li class="chapter-item "><a href="../../notes/rust/20220611-rust-learn-10.html">Rust å­¦ä¹  10</a></li><li class="chapter-item "><a href="../../notes/rust/20220619-rust-learn-11.html">Rust å­¦ä¹  11</a></li><li class="chapter-item "><a href="../../notes/rust/20220619-rust-learn-project-01.html">Rust å­¦ä¹  å®ä¾‹ 01</a></li><li class="chapter-item "><a href="../../notes/rust/20220623-rust-learn-12.html">Rust å­¦ä¹  12</a></li><li class="chapter-item "><a href="../../notes/rust/20220624-rust-learn-13.html">Rust å­¦ä¹  13</a></li><li class="chapter-item "><a href="../../notes/rust/20220925-rust-learn-14.html">Rust å­¦ä¹  14</a></li><li class="chapter-item "><a href="../../notes/rust/20220925-rust-learn-15.html">Rust å­¦ä¹  15</a></li><li class="chapter-item "><a href="../../notes/rust/20221030-rust-learn-final.html">Rust å­¦ä¹  final</a></li><li class="chapter-item "><a href="../../notes/rust/20221030-rust-learn-project-02.html">Rust å­¦ä¹  å®ä¾‹ 02</a></li></ol></li><li class="chapter-item "><a href="../../notes/postgresql/index.html">PostgreSQL</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/postgresql/20230502-psql-learn-01.html">PostgreSQL å­¦ä¹  01</a></li><li class="chapter-item "><a href="../../notes/postgresql/20231024-psql-learn-02.html">PostgreSQL å­¦ä¹  02</a></li><li class="chapter-item "><a href="../../notes/postgresql/20231110-psql-learn-03.html">PostgreSQL å­¦ä¹  03</a></li></ol></li><li class="chapter-item "><a href="../../notes/typechallenges/index.html">Type Challenges</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/typechallenges/20230425-type-challenges-01.html">TypeScript ç±»å‹ä½“æ“ 01</a></li><li class="chapter-item "><a href="../../notes/typechallenges/20230428-type-challenges-02.html">TypeScript ç±»å‹ä½“æ“ 02</a></li></ol></li><li class="chapter-item "><li class="part-title">Miscellany</li><li class="chapter-item "><a href="../../miscellany/coding/index.html">Coding</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/coding/20210604-scope-of-if-statement.html">if è¯­å¥çš„ä½œç”¨åŸŸ</a></li><li class="chapter-item "><a href="../../miscellany/coding/20221026-parse-math-in-c.html">C è¯­è¨€æ•°å­¦è§£æå™¨</a></li><li class="chapter-item "><a href="../../miscellany/coding/20231107-clash-system-agent.html">Cğœ†ash ç³»ç»Ÿä»£ç†</a></li><li class="chapter-item "><a href="../../miscellany/coding/20240228-use-giscus-in-mdbook.html">åœ¨ mdBook ä¸­ä½¿ç”¨ giscus æœåŠ¡</a></li></ol></li><li class="chapter-item "><a href="../../miscellany/study/index.html">Study</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/study/20221108-qiskit-linear-algebra.html">qiskit çº¿æ€§ä»£æ•°</a></li><li class="chapter-item "><a href="../../miscellany/study/20221111-qiskit-Deutsch-Jozsa-algorithm.html">qiskit Deutsch-Jozsa ç®—æ³•</a></li></ol></li><li class="chapter-item "><a href="../../miscellany/life/index.html">Life</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/life/20230411-about-life.html">è¯´è¯´ä»¥åçš„æ‰“ç®—ç½¢</a></li><li class="chapter-item "><a href="../../miscellany/life/20230715-about-job.html">è°ˆè°ˆæœ€è¿‘çš„å·¥ä½œçŠ¶æ€</a></li><li class="chapter-item "><a href="../../miscellany/life/20230915-end-of-summer.html">æš‘å‡ç»“æŸäº†</a></li><li class="chapter-item "><a href="../../miscellany/life/20231020-new-life.html">æ–°çš„ç”Ÿæ´»</a></li><li class="chapter-item "><a href="../../miscellany/life/20240120-busy-life.html">å¿™å¿™ç¢Œç¢Œ</a></li></ol></li></ol>
                </div>
                <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                    <div class="sidebar-resize-indicator"></div>
                </div>
            </nav>

            <script>
                var sidebarScrollbox = document.querySelector("#sidebar .sidebar-scrollbox");
                sidebarScrollbox.addEventListener(
                    "click",
                    function (e) {
                        if (e.target.tagName === "A") {
                            sessionStorage.setItem("sidebar-scroll", sidebarScrollbox.scrollTop);
                        }
                    },
                    { passive: true }
                );
                var sidebarScrollTop = sessionStorage.getItem("sidebar-scroll");
                sessionStorage.removeItem("sidebar-scroll");
                if (sidebarScrollTop) {
                    // preserve sidebar scroll position when navigating via links within sidebar
                    sidebarScrollbox.scrollTop = sidebarScrollTop;
                } else {
                    // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                    var activeSection = document.querySelector("#sidebar .active");
                    if (activeSection) {
                        activeSection.scrollIntoView({ block: "center" });
                    }
                }
            </script>

            <div id="page-wrapper" class="page-wrapper">
                <div class="page">
                                        <div id="menu-bar-hover-placeholder"></div>
                    <div id="menu-bar" class="menu-bar sticky">
                        <div class="left-buttons">
                            <label id="sidebar-toggle" class="icon-button"
                                for="sidebar-toggle-anchor"
                                title="Toggle Table of Contents"
                                aria-label="Toggle Table of Contents"
                                aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </label>
                            <button id="theme-toggle" class="icon-button"
                                type="button" title="Change theme"
                                aria-label="Change theme" aria-haspopup="true"
                                aria-expanded="false"
                                aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup"
                                aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="light">Light</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            <button id="search-toggle" class="icon-button"
                                type="button" title="Search. (Shortkey: s)"
                                aria-label="Toggle Searchbar"
                                aria-expanded="false" aria-keyshortcuts="S"
                                aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                        <h1 class="menu-title">Kevin Stephen&#x27;s Blogs</h1>
                        <div class="right-buttons">
                            <a href="https://github.com/kands-code/kands-code.github.io"
                                title="Git repository"
                                aria-label="Git repository">
                                <i id="git-repository-button"
                                    class="fa fa-github"></i>
                            </a>
                            <a href="https://github.com/kands-code/kands-code.github.io/edit/repo-src/src/src/notes/rust/20220512-rust-learn-05.md"
                                title="Suggest an edit"
                                aria-label="Suggest an edit">
                                <i id="git-edit-button" class="fa fa-edit"></i>
                            </a>
                        </div>
                    </div>
                    <div id="search-wrapper" class="hidden">
                        <form id="searchbar-outer" class="searchbar-outer">
                            <input type="search" id="searchbar" name="searchbar"
                                placeholder="searching..."
                                aria-controls="searchresults-outer"
                                aria-describedby="searchresults-header">
                        </form>
                        <div id="searchresults-outer"
                            class="searchresults-outer hidden">
                            <div id="searchresults-header"
                                class="searchresults-header"></div>
                            <ul id="searchresults">
                            </ul>
                        </div>
                    </div>
                    <script>
                        document
                            .getElementById("sidebar-toggle")
                            .setAttribute("aria-expanded", sidebar === "visible");
                        document
                            .getElementById("sidebar")
                            .setAttribute("aria-hidden", sidebar !== "visible");
                        Array.from(document.querySelectorAll("#sidebar a")).forEach(function (link) {
                            link.setAttribute("tabIndex", sidebar === "visible" ? 0 : -1);
                        });
                    </script>

                    <div id="content" class="content">
                        <main><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="rust-å­¦ä¹ -05"><a class="header" href="#rust-å­¦ä¹ -05">Rust å­¦ä¹  05</a></h1>
<p class="archive-time">archive time: 2022-05-12</p>
<p class="sp-comment">å¥½ä¹…æ²¡æ›´æ–°åšå®¢äº†, å†å­¦å­¦ Rust ç½¢</p>
<ul>
<li><a href="#%E6%89%80%E6%9C%89%E6%9D%83">æ‰€æœ‰æƒ</a>
<ul>
<li><a href="#stack-%E5%86%85%E5%AD%98">Stack å†…å­˜</a></li>
<li><a href="#heap-%E5%86%85%E5%AD%98">Heap å†…å­˜</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94">å¯¹æ¯”</a></li>
<li><a href="#%E8%A7%84%E5%88%99">è§„åˆ™</a></li>
</ul>
</li>
<li><a href="#string-%E7%B1%BB%E5%9E%8B">String ç±»å‹</a></li>
<li><a href="#%E5%8F%98%E9%87%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92">å˜é‡å’Œæ•°æ®äº¤äº’</a>
<ul>
<li><a href="#%E7%A7%BB%E5%8A%A8">ç§»åŠ¨</a></li>
<li><a href="#clone">clone</a></li>
<li><a href="#%E5%A4%8D%E5%88%B6">å¤åˆ¶</a></li>
</ul>
</li>
<li><a href="#%E6%89%80%E6%9C%89%E6%9D%83%E4%B8%8E%E5%87%BD%E6%95%B0">æ‰€æœ‰æƒä¸å‡½æ•°</a></li>
<li><a href="#%E5%BC%95%E7%94%A8%E5%92%8C%E5%80%9F%E7%94%A8">å¼•ç”¨å’Œå€Ÿç”¨</a></li>
<li><a href="#%E5%88%87%E7%89%87">åˆ‡ç‰‡</a></li>
</ul>
<h2 id="æ‰€æœ‰æƒ"><a class="header" href="#æ‰€æœ‰æƒ">æ‰€æœ‰æƒ</a></h2>
<p>è¿™ç®—æ˜¯ Rust çš„æ ‡å¿—ä¹‹ä¸€äº†, è¿™ä¹Ÿæ˜¯ Rust çš„å†…å­˜å®‰å…¨çš„ä¿éšœ</p>
<ul>
<li>å†…å­˜é€šè¿‡ä¸€ä¸ªæ‰€æœ‰æƒç³»ç»Ÿæ¥ç®¡ç†, åŒ…å«ä¸€ç»„ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥çš„è§„åˆ™</li>
<li>å½“ç¨‹åºè¿è¡Œæ—¶, æ‰€æœ‰æƒç‰¹æ€§ä¸ä¼šå‡æ…¢ç¨‹åºçš„è¿è¡Œé€Ÿåº¦</li>
</ul>
<h3 id="stack-å†…å­˜"><a class="header" href="#stack-å†…å­˜">Stack å†…å­˜</a></h3>
<p>Stack ä¿æŒ <em>LIFO (last in first out)</em> çš„è§„åˆ™å­˜å‚¨æ•°æ®</p>
<p>å­˜æ•°æ®çš„æ–¹å¼ä¸º <em>push ( å‹æ ˆ )</em>, å–æ•°æ®çš„æ–¹å¼ä¸º <em>pop ( å¼¹æ ˆ )</em></p>
<p>è€Œä¸”åœ¨ Stack ä¸Šçš„æ•°æ®å¤§å°æ˜¯å›ºå®šçš„æˆ–è€…å·²çŸ¥çš„</p>
<h3 id="heap-å†…å­˜"><a class="header" href="#heap-å†…å­˜">Heap å†…å­˜</a></h3>
<p>ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥çš„æˆ–è€…ä¼šæ”¹å˜å¤§å°çš„æ•°æ®éƒ½ä¼šå­˜æ”¾åœ¨ Heap ä¸Š</p>
<ul>
<li>æŠŠæ•°æ®æ”¾å…¥ Heap æ—¶ä¼šè¯·æ±‚ä¸€å®šæ•°é‡çš„ç©ºé—´</li>
<li>æ“ä½œç³»ç»Ÿä¼šåœ¨ Heap ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´æ¥å­˜æ”¾, å¹¶å°†å…¶æ ‡è®°ä¸ºå ç”¨, è¿”å›è¯¥åœ°å€æŒ‡é’ˆ</li>
</ul>
<p>è¯¥æ“ä½œè¢«ç§°ä¸º <em>å†…å­˜åˆ†é…</em></p>
<h3 id="å¯¹æ¯”"><a class="header" href="#å¯¹æ¯”">å¯¹æ¯”</a></h3>
<ul>
<li>æŠŠå€¼æ”¾åˆ° Stack ä¸Šä¸å«åšåˆ†é…</li>
<li>å› ä¸ºæŒ‡é’ˆçš„å¤§å°æ˜¯å›ºå®šçš„, æ‰€ä»¥æŒ‡é’ˆæ˜¯å¯ä»¥æ”¾åœ¨ Stack ä¸Šçš„
<ul>
<li>ä½†æ˜¯è¦å–åˆ°å…·ä½“çš„å€¼éœ€è¦æŒ‡é’ˆå®šä½</li>
</ul>
</li>
<li>æ•°æ®å‹åˆ° Stack ä¸Šè¦æ¯”åœ¨ Heap ä¸Šåˆ†é…è¦å¿«
<ul>
<li>Stack æ˜¯ç›´æ¥åœ¨é¡¶ç«¯å­˜æ”¾æ•°æ®, æ— éœ€å¯»æ‰¾åˆé€‚ç©ºé—´</li>
<li>Heap ä¼šå¯»æ‰¾åˆé€‚å¤§å°çš„ç©ºé—´æ¥å­˜æ”¾æ•°æ®</li>
</ul>
</li>
<li>è®¿é—® Stack è¦æ¯” Heap å¿«, å› ä¸ºè¦æ‰¾ Heap æ•°æ®éœ€è¦ç”¨æŒ‡é’ˆæ¥å¯»æ‰¾</li>
</ul>
<p>æ‰€æœ‰æƒå¯ä»¥è·Ÿè¸ªæ­£åœ¨ä½¿ç”¨çš„æ•°æ®, è€Œä¸”å¯ä»¥æœ€å°åŒ– Heap ä¸Šé‡å¤æ•°æ®é‡, å¹¶ä¸”å¯ä»¥æ¸…ç† Heap ä¸Šæœªä½¿ç”¨çš„æ•°æ®</p>
<h3 id="è§„åˆ™"><a class="header" href="#è§„åˆ™">è§„åˆ™</a></h3>
<ol>
<li>æ¯ä¸ªå€¼éƒ½æœ‰ä¸ªå¯¹åº”å˜é‡, è¯¥å˜é‡ä¸ºè¯¥å€¼æ‰€æœ‰è€… (Owner)</li>
<li>æ¯ä¸ªå€¼åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…</li>
<li>æ‰€æœ‰è€…è¶…å‡ºä½œç”¨åŸŸæ—¶, è¯¥å€¼å°†ä¼šè¢«åˆ é™¤ (æœªè¢«ä½¿ç”¨)</li>
</ol>
<blockquote>
<p>ä½œç”¨åŸŸ (Scope) æ˜¯å¯¹è±¡ (item, object) æœ‰æ•ˆçš„èŒƒå›´</p>
</blockquote>
<pre><code class="language-rust">fn main() {
    // s ä¸å¯ç”¨
    let s = "hello"; // s å¯ç”¨
    // s ä½œç”¨åŸŸèŒƒå›´
} // s ä¸å†å¯ç”¨, å¯¹åº”å€¼å°†è¢«åˆ é™¤</code></pre>
<h2 id="string-ç±»å‹"><a class="header" href="#string-ç±»å‹">String ç±»å‹</a></h2>
<p>String æ¯”åŸºç¡€æ ‡é‡ç±»å‹ (scalar type ä¸å¯å†åˆ†ç±»å‹) æ›´å¤æ‚</p>
<ul>
<li>å­—ç¬¦ä¸²å­—é¢å€¼ (literal) æ˜¯ä¸å¯å˜çš„</li>
<li>String ç±»å‹åœ¨ Heap ä¸Šåˆ†é…, å¯ä»¥å­˜æ”¾æœªçŸ¥æ•°é‡çš„æ–‡æœ¬</li>
</ul>
<pre><code class="language-rust">let s1 = "hello"; // å­—é¢å€¼
let s2 = String::from("hello"); // String ç±»å‹</code></pre>
<p>String ç±»å‹æ˜¯å¯ä»¥ä¿®æ”¹çš„</p>
<pre><code class="language-rust">fn main() {
    let mut s = String::from("Hello");
    s.push_str(", World");
    println!("{}", s); // =&gt; Hello, World
} // drop å‡½æ•°</code></pre>
<h2 id="å˜é‡å’Œæ•°æ®äº¤äº’"><a class="header" href="#å˜é‡å’Œæ•°æ®äº¤äº’">å˜é‡å’Œæ•°æ®äº¤äº’</a></h2>
<h3 id="ç§»åŠ¨"><a class="header" href="#ç§»åŠ¨">ç§»åŠ¨</a></h3>
<p>ä¸¤ä¸ª <code>5</code> è¢«å‹å…¥äº† Stack ä¸­</p>
<pre><code class="language-rust">let x = 5;
let y = x;</code></pre>
<p>å¯¹äº String ç±»å‹</p>
<pre><code class="language-rust">let s1 = String::from("Hello"); // ptr, len, capacity
let s2 = s1; // s2 æœ‰å’Œ s1 ä¸€æ ·çš„å€¼, æ‰€ä»¥ ptr æŒ‡å‘åŒä¸€ä¸ªå­—ç¬¦ä¸²
// s1 å¤±æ•ˆ
// println!("{}", s1); // é”™è¯¯ borrow of moved value</code></pre>
<p>åœ¨ Java é‡Œ, è¿™ç§æ²¡æœ‰å¤åˆ¶å€¼çš„æƒ…å†µè¢«ç§°ä¸º <em>æµ…æ‹·è´ (shallow copy)</em></p>
<p>ä½†æ˜¯ Rust è¿˜è®© <code>s1</code> å¤±æ•ˆäº†, æ•…è¿™ç§è¡Œä¸ºè¢«ç§°ä¸º <em>ç§»åŠ¨ (move)</em></p>
<h3 id="clone"><a class="header" href="#clone">clone</a></h3>
<p>å¦‚æœæƒ³è¦è¿›è¡Œæ·±æ‹·è´, åˆ™å¯ä»¥ä½¿ç”¨ <code>clone</code> æ–¹æ³•</p>
<pre><code class="language-rust">let s1 = String::from("Hello"); // ptr, len, capacity
let s2 = s1.clone(); // è¿ Heap æ•°æ®ä¹Ÿå¤åˆ¶äº†ä¸€ä»½
println!("{}, {}", s1, s2); // æ­£å¸¸</code></pre>
<h3 id="å¤åˆ¶"><a class="header" href="#å¤åˆ¶">å¤åˆ¶</a></h3>
<p>ç§»åŠ¨ å’Œ clone æ˜¯é’ˆå¯¹äº Heap å…ƒç´ è¯´çš„</p>
<p>å¯¹äº Stack å…ƒç´ æ‰§è¡Œçš„æ˜¯å¤åˆ¶, æ·±æ‹·è´å’Œæµ…æ‹·è´æ˜¯ä¸€æ ·çš„</p>
<blockquote>
<p>å¦‚æœå®ç°äº† Copy trait, åˆ™æ—§å˜é‡åœ¨èµ‹å€¼åä»å¯ç”¨</p>
<p>å¦‚æœå®ç°äº† Drop trait, åˆ™æ— æ³•å®ç° Copy trait</p>
</blockquote>
<p>ç®€å•çš„æ ‡é‡ç»„åˆç±»å‹éƒ½æ˜¯å®ç°äº† Copy çš„</p>
<p>è€Œéœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§èµ„æºçš„éƒ½æ²¡å®ç° Copy çš„</p>
<h2 id="æ‰€æœ‰æƒä¸å‡½æ•°"><a class="header" href="#æ‰€æœ‰æƒä¸å‡½æ•°">æ‰€æœ‰æƒä¸å‡½æ•°</a></h2>
<p>å¯ä»¥é€šè¿‡è¿™ä¸ªä¾‹å­æ¥çœ‹çœ‹</p>
<pre><code class="language-rust">fn main() {
    let s = String::from("hello");
    take_ownership(s);

    // println!("{}", s); // value borrowed here after move

    let x = 5;
    make_copy();

    println!("x: {}", x);
} // é‡Šæ”¾ x

fn take_ownership(some_string: String) {
    println!("{}", some_string);
} // drop some_string

fn make_copy(some_number: i32) {
    println!("{}", some_number);
}</code></pre>
<h2 id="å¼•ç”¨å’Œå€Ÿç”¨"><a class="header" href="#å¼•ç”¨å’Œå€Ÿç”¨">å¼•ç”¨å’Œå€Ÿç”¨</a></h2>
<p>å¦‚æœåªæƒ³ä½¿ç”¨å…¶å€¼è€Œä¸è·å–å…¶æ‰€æœ‰æƒ, å¯ä»¥ä½¿ç”¨å¼•ç”¨ (ref)</p>
<pre><code class="language-rust">fn main() {
    let s = String::form("hello");
    let len = length(&amp;s); // ä¼ å…¥å¼•ç”¨

    println!("{}: {}", s, len); // Ok
}

fn length(s: &amp;String) -&gt; usize { // æ¥æ”¶å¼•ç”¨
    return s.len();
}</code></pre>
<p>æŠŠå¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°çš„è¡Œä¸ºè¢«å«åš <em>å€Ÿç”¨</em></p>
<p>åœ¨ç‰¹å®šä½œç”¨åŸŸå†…å¯¹æŸå—æ•°æ®åªèƒ½æœ‰ <strong>ä¸€ä¸ª</strong> å¯å˜å¼•ç”¨</p>
<ul>
<li>å¯ä»¥é˜²æ­¢æ•°æ®ç«äº‰
<ul>
<li>ä¸¤ä¸ªæˆ–å¤šä¸ªæŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€ä¸ªæ•°æ®</li>
<li>è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆç”¨äºå†™å…¥æ•°æ®</li>
<li>æ²¡æœ‰ä½¿ç”¨ä»»ä½•æœºåˆ¶æ¥åŒæ­¥ (sync) æ•°æ®çš„è®¿é—®</li>
</ul>
</li>
</ul>
<p>ä½†æ˜¯å¯ä»¥åˆ›å»ºæ–°çš„ä½œç”¨åŸŸæ¥å…è®¸éåŒæ—¶çš„åˆ›å»ºå¤šä¸ªå¯å˜å¼•ç”¨</p>
<pre><code class="language-rust">let mut s = String::from("hello");

{
    let s1 = &amp;mut s;
}

let s2 = &amp;mut s;</code></pre>
<p>ä¸å¯ä»¥åŒæ—¶æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨å’Œä¸å¯å˜å¼•ç”¨, ä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨</p>
<blockquote>
<p>æ‚¬ç©ºå¼•ç”¨ ä¼šåœ¨ç¼–è¯‘æœŸè¢«æŸ¥å‡º</p>
</blockquote>
<h2 id="åˆ‡ç‰‡"><a class="header" href="#åˆ‡ç‰‡">åˆ‡ç‰‡</a></h2>
<p>åˆ‡ç‰‡æŒ‡å‘åŸæ¥å€¼çš„ä¸€éƒ¨åˆ†</p>
<pre><code class="language-rust">fn main() {
    let mut s = String::from("hello world");
    let wordIndex = first_word(&amp;s[..]);

    // s.clear(); // ä¸å¯ä»¥æŠŠ s å€Ÿç”¨ä¸ºå¯å˜
    println!("{}", wordIndex);
}

fn first_word(s: &amp;str) -&gt; &amp;str { // è¿”å›å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹
    let bytes = s.as_bytes();

    for (i, &amp;item) in bytes.iter().enumerate() {
        if item == b' ' {
            return &amp;s[.. i];
        }
    }

    return &amp;s[..];
}</code></pre>
<hr />
<p>å¥½, æš‚æ—¶å°±è¿™æ ·ç½¢, å›ºä½“ç‰©ç†å­¦å¥½éš¾å•Š</p>
</main>
                        <nav class="nav-wrapper" aria-label="Page navigation">
                            <a rel="prev" href="../../notes/rust/20211216-rust-learn-04.html"
                                class="mobile-nav-chapters previous"
                                title="Previous chapter"
                                aria-label="Previous chapter"
                                aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next prefetch"
                                href="../../notes/rust/20220514-rust-learn-06.html"
                                class="mobile-nav-chapters next"
                                title="Next chapter" aria-label="Next chapter"
                                aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                            <div style="clear: both"></div>
                        </nav>
                    </div>
                </div>
                <div class="giscus-comment">
                </div>
                <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../notes/rust/20211216-rust-learn-04.html"
                        class="nav-chapters previous" title="Previous chapter"
                        aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next prefetch" href="../../notes/rust/20220514-rust-learn-06.html"
                        class="nav-chapters next" title="Next chapter"
                        aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                </nav>
            </div>
            <script>
                window.playground_copyable = true;
            </script>
            <script src="../../elasticlunr.min.js"></script>
            <script src="../../mark.min.js"></script>
            <script src="../../searcher.js"></script>
            <script src="../../clipboard.min.js"></script>
            <script src="../../highlight.js"></script>
            <script src="../../book.js"></script>
            <script src="../../theme/giscus.js"></script>
        </div>
    </body>
</html>
