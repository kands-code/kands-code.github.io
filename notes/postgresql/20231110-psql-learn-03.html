<!DOCTYPE HTML>
<html
    lang="zh-Hans" 
    class="rust" 
    dir="ltr"> 
    <head>
        <title>PostgreSQL å­¦ä¹  03 - Kevin Stephen&#x27;s Blogs</title> 
        <meta charset="UTF-8">
        <meta name="description" content="æ‰¾åˆ°å±äºè‡ªå·±çš„å…‰">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">
        
         
        <link rel="icon" href="../../favicon.svg">
         
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <link rel="stylesheet"
            href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <link rel="stylesheet" href="../../theme/utils.css">

    </head>
    <body class="sidebar-visible no-js">
        <div id="body-container">
            <script>
                // è·å– root è·¯å¾„
                var path_to_root = "../../";
                // è·å–é»˜è®¤ä¸»é¢˜
                var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches
                    ? "ayu"
                    : "rust";
            </script>
            <script>
                try {
                    var theme = localStorage.getItem("mdbook-theme");
                    var sidebar = localStorage.getItem("mdbook-sidebar");

                    if (theme.startsWith('"') && theme.endsWith('"')) {
                        localStorage.setItem(
                            "mdbook-theme",
                            theme.slice(1, theme.length - 1).trim()
                        );
                    }

                    if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                        localStorage.setItem(
                            "mdbook-sidebar",
                            sidebar.slice(1, sidebar.length - 1).trim()
                        );
                    }
                } catch (e) {}
            </script>
            <script>
                var theme;
                try {
                    theme = localStorage.getItem("mdbook-theme");
                } catch (e) {}
                if (theme === null || theme === undefined) {
                    theme = default_theme;
                }
                var html = document.querySelector("html");
                html.classList.remove("rust");
                html.classList.add(theme);
                var body = document.querySelector("body");
                body.classList.remove("no-js");
                body.classList.add("js");
            </script>

            <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">
            <script>
                var body = document.querySelector("body");
                var sidebar = null;
                var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
                if (document.body.clientWidth >= 1080) {
                try {
                    sidebar = localStorage.getItem("mdbook-sidebar");
                } catch (e) {}
                    sidebar = sidebar || "visible";
                } else {
                    sidebar = "hidden";
                }
                sidebar_toggle.checked = sidebar === "visible";
                body.classList.remove("sidebar-visible");
                body.classList.add("sidebar-" + sidebar);
            </script>

            <nav id="sidebar" class="sidebar" aria-label="Table of contents">
                <div class="sidebar-scrollbox">
                    <ol class="chapter"><li class="chapter-item "><a href="../../init.html">Init</a></li><li class="chapter-item "><a href="../../about.html">About</a></li><li class="chapter-item affix "><li class="part-title">Notes</li><li class="chapter-item "><a href="../../notes/rust/index.html">Rust</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/rust/20210605-rust-learn-01.html">Rust å­¦ä¹  01</a></li><li class="chapter-item "><a href="../../notes/rust/20210610-rust-learn-02.html">Rust å­¦ä¹  02</a></li><li class="chapter-item "><a href="../../notes/rust/20210824-rust-learn-03.html">Rust å­¦ä¹  03</a></li><li class="chapter-item "><a href="../../notes/rust/20211216-rust-learn-04.html">Rust å­¦ä¹  04</a></li><li class="chapter-item "><a href="../../notes/rust/20220512-rust-learn-05.html">Rust å­¦ä¹  05</a></li><li class="chapter-item "><a href="../../notes/rust/20220514-rust-learn-06.html">Rust å­¦ä¹  06</a></li><li class="chapter-item "><a href="../../notes/rust/20220520-rust-learn-07.html">Rust å­¦ä¹  07</a></li><li class="chapter-item "><a href="../../notes/rust/20220522-rust-learn-08.html">Rust å­¦ä¹  08</a></li><li class="chapter-item "><a href="../../notes/rust/20220523-rust-learn-09.html">Rust å­¦ä¹  09</a></li><li class="chapter-item "><a href="../../notes/rust/20220611-rust-learn-10.html">Rust å­¦ä¹  10</a></li><li class="chapter-item "><a href="../../notes/rust/20220619-rust-learn-11.html">Rust å­¦ä¹  11</a></li><li class="chapter-item "><a href="../../notes/rust/20220619-rust-learn-project-01.html">Rust å­¦ä¹  å®ä¾‹ 01</a></li><li class="chapter-item "><a href="../../notes/rust/20220623-rust-learn-12.html">Rust å­¦ä¹  12</a></li><li class="chapter-item "><a href="../../notes/rust/20220624-rust-learn-13.html">Rust å­¦ä¹  13</a></li><li class="chapter-item "><a href="../../notes/rust/20220925-rust-learn-14.html">Rust å­¦ä¹  14</a></li><li class="chapter-item "><a href="../../notes/rust/20220925-rust-learn-15.html">Rust å­¦ä¹  15</a></li><li class="chapter-item "><a href="../../notes/rust/20221030-rust-learn-final.html">Rust å­¦ä¹  final</a></li><li class="chapter-item "><a href="../../notes/rust/20221030-rust-learn-project-02.html">Rust å­¦ä¹  å®ä¾‹ 02</a></li></ol></li><li class="chapter-item expanded "><a href="../../notes/postgresql/index.html">PostgreSQL</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/postgresql/20230502-psql-learn-01.html">PostgreSQL å­¦ä¹  01</a></li><li class="chapter-item "><a href="../../notes/postgresql/20231024-psql-learn-02.html">PostgreSQL å­¦ä¹  02</a></li><li class="chapter-item expanded "><a href="../../notes/postgresql/20231110-psql-learn-03.html" class="active">PostgreSQL å­¦ä¹  03</a></li></ol></li><li class="chapter-item "><a href="../../notes/typechallenges/index.html">Type Challenges</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../notes/typechallenges/20230425-type-challenges-01.html">TypeScript ç±»å‹ä½“æ“ 01</a></li><li class="chapter-item "><a href="../../notes/typechallenges/20230428-type-challenges-02.html">TypeScript ç±»å‹ä½“æ“ 02</a></li></ol></li><li class="chapter-item "><li class="part-title">Miscellany</li><li class="chapter-item "><a href="../../miscellany/coding/index.html">Coding</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/coding/20210604-scope-of-if-statement.html">if è¯­å¥çš„ä½œç”¨åŸŸ</a></li><li class="chapter-item "><a href="../../miscellany/coding/20221026-parse-math-in-c.html">C è¯­è¨€æ•°å­¦è§£æå™¨</a></li><li class="chapter-item "><a href="../../miscellany/coding/20231107-clash-system-agent.html">Cğœ†ash ç³»ç»Ÿä»£ç†</a></li><li class="chapter-item "><a href="../../miscellany/coding/20240228-use-giscus-in-mdbook.html">åœ¨ mdBook ä¸­ä½¿ç”¨ giscus æœåŠ¡</a></li></ol></li><li class="chapter-item "><a href="../../miscellany/study/index.html">Study</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/study/20221108-qiskit-linear-algebra.html">qiskit çº¿æ€§ä»£æ•°</a></li><li class="chapter-item "><a href="../../miscellany/study/20221111-qiskit-Deutsch-Jozsa-algorithm.html">qiskit Deutsch-Jozsa ç®—æ³•</a></li></ol></li><li class="chapter-item "><a href="../../miscellany/life/index.html">Life</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../miscellany/life/20230411-about-life.html">è¯´è¯´ä»¥åçš„æ‰“ç®—ç½¢</a></li><li class="chapter-item "><a href="../../miscellany/life/20230715-about-job.html">è°ˆè°ˆæœ€è¿‘çš„å·¥ä½œçŠ¶æ€</a></li><li class="chapter-item "><a href="../../miscellany/life/20230915-end-of-summer.html">æš‘å‡ç»“æŸäº†</a></li><li class="chapter-item "><a href="../../miscellany/life/20231020-new-life.html">æ–°çš„ç”Ÿæ´»</a></li><li class="chapter-item "><a href="../../miscellany/life/20240120-busy-life.html">å¿™å¿™ç¢Œç¢Œ</a></li></ol></li></ol>
                </div>
                <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                    <div class="sidebar-resize-indicator"></div>
                </div>
            </nav>

            <script>
                var sidebarScrollbox = document.querySelector("#sidebar .sidebar-scrollbox");
                sidebarScrollbox.addEventListener(
                    "click",
                    function (e) {
                        if (e.target.tagName === "A") {
                            sessionStorage.setItem("sidebar-scroll", sidebarScrollbox.scrollTop);
                        }
                    },
                    { passive: true }
                );
                var sidebarScrollTop = sessionStorage.getItem("sidebar-scroll");
                sessionStorage.removeItem("sidebar-scroll");
                if (sidebarScrollTop) {
                    // preserve sidebar scroll position when navigating via links within sidebar
                    sidebarScrollbox.scrollTop = sidebarScrollTop;
                } else {
                    // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                    var activeSection = document.querySelector("#sidebar .active");
                    if (activeSection) {
                        activeSection.scrollIntoView({ block: "center" });
                    }
                }
            </script>

            <div id="page-wrapper" class="page-wrapper">
                <div class="page">
                                        <div id="menu-bar-hover-placeholder"></div>
                    <div id="menu-bar" class="menu-bar sticky">
                        <div class="left-buttons">
                            <label id="sidebar-toggle" class="icon-button"
                                for="sidebar-toggle-anchor"
                                title="Toggle Table of Contents"
                                aria-label="Toggle Table of Contents"
                                aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </label>
                            <button id="theme-toggle" class="icon-button"
                                type="button" title="Change theme"
                                aria-label="Change theme" aria-haspopup="true"
                                aria-expanded="false"
                                aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup"
                                aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="light">Light</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme"
                                        id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem"
                                        class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            <button id="search-toggle" class="icon-button"
                                type="button" title="Search. (Shortkey: s)"
                                aria-label="Toggle Searchbar"
                                aria-expanded="false" aria-keyshortcuts="S"
                                aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                        <h1 class="menu-title">Kevin Stephen&#x27;s Blogs</h1>
                        <div class="right-buttons">
                            <a href="https://github.com/kands-code/kands-code.github.io"
                                title="Git repository"
                                aria-label="Git repository">
                                <i id="git-repository-button"
                                    class="fa fa-github"></i>
                            </a>
                            <a href="https://github.com/kands-code/kands-code.github.io/edit/repo-src/src/src/notes/postgresql/20231110-psql-learn-03.md"
                                title="Suggest an edit"
                                aria-label="Suggest an edit">
                                <i id="git-edit-button" class="fa fa-edit"></i>
                            </a>
                        </div>
                    </div>
                    <div id="search-wrapper" class="hidden">
                        <form id="searchbar-outer" class="searchbar-outer">
                            <input type="search" id="searchbar" name="searchbar"
                                placeholder="searching..."
                                aria-controls="searchresults-outer"
                                aria-describedby="searchresults-header">
                        </form>
                        <div id="searchresults-outer"
                            class="searchresults-outer hidden">
                            <div id="searchresults-header"
                                class="searchresults-header"></div>
                            <ul id="searchresults">
                            </ul>
                        </div>
                    </div>
                    <script>
                        document
                            .getElementById("sidebar-toggle")
                            .setAttribute("aria-expanded", sidebar === "visible");
                        document
                            .getElementById("sidebar")
                            .setAttribute("aria-hidden", sidebar !== "visible");
                        Array.from(document.querySelectorAll("#sidebar a")).forEach(function (link) {
                            link.setAttribute("tabIndex", sidebar === "visible" ? 0 : -1);
                        });
                    </script>

                    <div id="content" class="content">
                        <main><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="postgresql-å­¦ä¹ -03"><a class="header" href="#postgresql-å­¦ä¹ -03">PostgreSQL å­¦ä¹  03</a></h1>
<p class="archive-time">archive time: 2023-11-10</p>
<p class="sp-comment">é—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œä¸å¦‚å­¦ä¸€ä¸‹ PostgreSQL</p>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E6%A0%BC%E8%AE%BE%E8%AE%A1">æ•°æ®åº“è¡¨æ ¼è®¾è®¡</a>
<ul>
<li><a href="#%E9%9C%80%E8%A6%81%E5%93%AA%E4%BA%9B%E8%A1%A8%E6%A0%BC">éœ€è¦å“ªäº›è¡¨æ ¼</a></li>
<li><a href="#%E8%A1%A8%E6%A0%BC%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB">è¡¨æ ¼é—´çš„å…³ç³»</a></li>
<li><a href="#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97">è‡ªåŠ¨ç”Ÿæˆåºåˆ—</a></li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E5%85%B3%E8%81%94%E6%95%B0%E6%8D%AE">æŸ¥è¯¢å…³è”æ•°æ®</a></li>
</ul>
<p>æœ€è¿‘ä¸€ç›´æ˜¯ä¼‘æ¯çŠ¶æ€ï¼Œä½†æ˜¯æ‡’æ•£ä¹…äº†æ€»æ„Ÿè§‰æœ‰ç‚¹å‘†ä¸ä½ï¼Œé‚£å°±å†å­¦ç‚¹ <strong><em>PostgreSQL</em></strong> å§</p>
<h2 id="æ•°æ®åº“è¡¨æ ¼è®¾è®¡"><a class="header" href="#æ•°æ®åº“è¡¨æ ¼è®¾è®¡">æ•°æ®åº“è¡¨æ ¼è®¾è®¡</a></h2>
<p>åŸºæœ¬ä¸Šï¼Œéœ€è¦ç”¨åˆ°æ•°æ®åº“çš„åœºåˆä¸‹ï¼Œä¸ä¼šåªæœ‰ä¸€ä¸ªè¡¨æ ¼éœ€è¦ç®¡ç†ï¼Œé€šå¸¸æ˜¯éœ€è¦ç®¡ç†å¤šä¸ªç›¸äº’å…³è”çš„è¡¨æ ¼</p>
<p>å¹¶ä¸”éœ€è¦çŸ¥é“ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®åº“çš„æ—¶å€™ï¼Œè¡¨æ ¼ç»“æ„ä¸€æ—¦ç¡®å®šä¸‹æ¥ï¼Œå‡ºäºç»´æŠ¤æ–¹ä¾¿å’Œæˆæœ¬è€ƒè™‘ï¼Œè½»æ˜“ä¸ä¼šä¿®æ”¹</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®ä¹‹é—´çš„ç®¡ç†å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œä¹Ÿå°±éœ€è¦æˆ‘ä»¬å¯¹äºè¡¨æ ¼æœ‰ä¸ªè‰¯å¥½çš„è®¾è®¡</p>
<h3 id="éœ€è¦å“ªäº›è¡¨æ ¼"><a class="header" href="#éœ€è¦å“ªäº›è¡¨æ ¼">éœ€è¦å“ªäº›è¡¨æ ¼</a></h3>
<p>åœ¨å¼€å§‹è®¾è®¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®è‡ªå·±çš„éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†é‚£äº›æ•°æ®ï¼Œæœ‰å“ªäº›è¡¨æ ¼éœ€è¦è®¾è®¡</p>
<p>åœ¨ <strong><em>SQL and PostgreSQL The Complete Developerâ€™s Guide</em></strong> ä¸­ï¼Œ
æˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªç»™ <strong><em>å›¾ç‰‡åˆ†äº«åº”ç”¨</em></strong> çš„æ•°æ®åº“ï¼Œå¤§è‡´åŒ…æ‹¬ <em>ç”¨æˆ·</em>ï¼Œ<em>å›¾ç‰‡</em>ï¼Œ<em>è¯„è®º</em> ä»¥åŠ <em>ç‚¹èµ</em> è¿™å‡ ä¸ªæ•°æ®</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æ•°æ®åº“ç»“æ„æ˜¯éœ€è¦æ ¹æ®ç¨‹åºçš„ç»“æ„è®¾è®¡çš„</p>
<p>ä¾‹å¦‚ç”¨æˆ·ï¼Œä¸€ä¸ªç”¨æˆ·ç±»å‹åŒ…æ‹¬äº† <em>ç”¨æˆ·å‘å¸–æ•°</em>ï¼Œ<em>ç”¨æˆ·è·Ÿéšæ•°</em>ï¼Œ<em>ç”¨æˆ·ç²‰ä¸æ•°</em> ä»¥åŠ <em>ç”¨æˆ·å¸–å­</em> å¤§æ¦‚è¿™äº›å†…å®¹</p>
<p>è€Œä¸€ä¸ªå¸–å­ï¼Œå¯èƒ½åŒ…å«äº† <em>æ ‡é¢˜</em>ï¼Œ<em>å¤´å›¾</em>ï¼Œ<em>å›¾ç‰‡</em> ä»¥åŠ <em>å›¾ç‰‡æè¿°</em> ç­‰å†…å®¹</p>
<p>è¿™äº›å°±æ˜¯æˆ‘ä»¬è®¾è®¡æ•°æ®åº“è¡¨æ ¼å’Œå…³ç³»çš„ä¾æ®</p>
<h3 id="è¡¨æ ¼é—´çš„å…³ç³»"><a class="header" href="#è¡¨æ ¼é—´çš„å…³ç³»">è¡¨æ ¼é—´çš„å…³ç³»</a></h3>
<p>è€Œåœ¨æˆ‘ä»¬è¦è®¾è®¡çš„è¿™å››ä¸ªè¡¨æ ¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œç”¨æˆ·æ˜¯å¯ä»¥å‘å›¾ç‰‡çš„ï¼Œç”¨æˆ·æ˜¯å¯ä»¥è¯„è®ºå’Œç‚¹èµåˆ«äººå¸–å­çš„ï¼Œ
ä¸€ä¸ªå›¾ç‰‡æ˜¯å¯ä»¥è¢«ç‚¹èµå’Œè¢«è¯„è®ºçš„ï¼Œç­‰ç­‰ï¼Œè¿™äº›å°±æ˜¯æˆ‘ä»¬è¯´çš„ â€œå…³ç³»â€</p>
<p>æˆ‘ä»¬å¸¸è§çš„å…³ç³»ç±»å‹æœ‰:</p>
<ul>
<li>ä¸€å¯¹å¤š: ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªå›¾ç‰‡</li>
<li>å¤šå¯¹ä¸€: å¤šå¼ ç…§ç‰‡å±äºåŒä¸€ä¸ªç”¨æˆ·</li>
<li>ä¸€å¯¹ä¸€: ä¸€ä¸ªè´¦æˆ·å¯¹åº”ä¸€ä¸ªç”¨æˆ·</li>
<li>å¤šå¯¹å¤š: å­¦ç”Ÿå¯èƒ½è¦ä¸Šå¤šé—¨è¯¾ï¼Œæ¯ä¸€é—¨è¯¾æœ‰å¾ˆå¤šå­¦ç”Ÿ</li>
</ul>
<p>è¿™äº›å…³ç³»è¿˜å¯ä»¥é€šè¿‡ <em>ä¸»é”®</em> å’Œ <em>å¤–é”®</em> æ¥ä½“ç°</p>
<p>æ‰€è°“ä¸»é”®ï¼Œå°±æ˜¯ä¸€ä¸ªè¡¨æ ¼ä¸­æ¯ä¸ªè®°å½•ç‹¬æœ‰çš„æ•°æ®</p>
<p>è€Œå¤–é”®æŒ‡çš„å°±æ˜¯è¿™ä¸ªè¡¨æ ¼çš„æ¯ä¸ªè®°å½•ä¸å…¶ä»–è¡¨æ ¼ä¸­è®°å½•çš„å…³ç³»</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å›¾ç‰‡è¡¨æ ¼ä¸­ï¼Œæ¯ä¸ªå›¾ç‰‡éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å“ˆå¸Œå€¼ï¼Œè¿™ä¸ªå¯ä»¥ä½œä¸ºå›¾ç‰‡çš„ä¸»é”®</p>
<p>æ¯ä¸ªå›¾ç‰‡éƒ½æ˜¯ç”±æŸä¸€ä½ç”¨æˆ·å‘çš„ï¼Œæ‰€ä»¥æœ‰ä¸ª <code>user_id</code> ä½œä¸ºè®°å·ï¼Œè¿™å°±æ˜¯å¯¹åº”çš„å¤–é”®</p>
<p>ä½†æ˜¯ä¸€ä¸ªç”¨æˆ·å¯ä»¥å‘å¤šä¸ªå›¾ç‰‡ï¼Œè¿™å°±æ„å‘³ç€å¤šä¸ªå›¾ç‰‡çš„ <code>user_id</code> å¯ä»¥ä¸€æ ·ï¼Œä½†æ˜¯å“ˆå¸Œå€¼ä¸€å®šæ˜¯ä¸åŒçš„</p>
<h3 id="è‡ªåŠ¨ç”Ÿæˆåºåˆ—"><a class="header" href="#è‡ªåŠ¨ç”Ÿæˆåºåˆ—">è‡ªåŠ¨ç”Ÿæˆåºåˆ—</a></h3>
<p>å¯¹äºå›¾ç‰‡ ID æˆ–è€…ç”¨æˆ· ID ä¸€ç±»çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è‡ªå·±ç”Ÿæˆï¼Œç„¶åæ‰‹åŠ¨æ’å…¥åˆ°æ•°æ®åº“</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®©æ•°æ®åº“è‡ªå·±ä¸ºæˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„åºåˆ—ï¼Œä¹Ÿå°±æ˜¯ <code>serial</code> ç±»å‹</p>
<pre><code class="language-sql">create table users (
  id serial primary key
  , username character varying (64)
);
</code></pre>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™å°±ä¸éœ€è¦æ’å…¥ <code>id</code>ï¼Œè€Œæ˜¯åªéœ€è¦ç»™æ•°æ®åº“ <code>username</code> å°±å¥½</p>
<pre><code class="language-sql">insert into users (
  username
) values
  ('Alice')
  , ('Bob')
  , ('Susan')
  , ('Jack');
</code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„ <code>users</code> è¡¨æ ¼æ•°æ®å°±æ˜¯:</p>
<pre><code class="language-text">psqldev=# select * from users;
 id | username
----+----------
  1 | Alice
  2 | Bob
  3 | Susan
  4 | Jack
(4 è¡Œè®°å½•)
</code></pre>
<p>å¯¹äºå›¾ç‰‡è¡¨æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼çš„è®¾è®¡</p>
<pre><code class="language-sql">create table photos (
  id serial primary key
  , url character varying (256)
  , user_id integer references users(id)
);
</code></pre>
<p>å›¾ç‰‡ ID æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å“ˆå¸Œå€¼ï¼Œå› ä¸ºè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å­˜å‚¨å›¾ç‰‡ï¼Œæ‰€ä»¥ä½¿ç”¨åºåˆ—å°±å¥½äº†</p>
<p>å…¶æ¬¡ï¼Œä¸ºäº†è¡¨æ˜å›¾ç‰‡ä¸ç”¨æˆ·çš„å…³ç³»ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† ç”¨æˆ· ID ä½œä¸ºå¤–é”®</p>
<p>å¤–é”®çš„è¯­æ³•æ˜¯:</p>
<pre><code class="language-sql">&lt;name&gt; &lt;type&gt; references &lt;table name&gt;(&lt;cols&gt;)
</code></pre>
<p>ä¹Ÿå°±æ˜¯ <code>&lt;name&gt;</code> è¿™ä¸ªåå­—çš„æ•°æ®å¯¹åº”çš„æ˜¯ <code>&lt;table name&gt;</code> è¿™ä¸ªè¡¨ä¸­çš„ <code>&lt;cols&gt;</code> å¯¹åº”æ•°æ®</p>
<p>å¯¹è¿™ä¸ªè¡¨æ’å…¥æ•°æ®æ˜¯ç±»ä¼¼çš„:</p>
<pre><code class="language-sql">insert into photos (
  url
  , user_id
) values
  ('https://img1.jpg', 4)
  , ('https://img2.jpg', 4)
  , ('https://img3.jpg', 2)
  , ('https://img4.jpg', 3)
  , ('https://img5.jpg', 3)
  , ('https://img6.jpg', 2)
  , ('https://img7.jpg', 1)
  , ('https://img8.jpg', 1)
  , ('https://img9.jpg', 1);
</code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„ <code>photos</code> è¡¨æ ¼æ•°æ®ä¸º:</p>
<pre><code class="language-text">psqldev=# select * from photos;
 id |       url        | user_id
----+------------------+---------
  1 | https://img1.jpg |       4
  2 | https://img2.jpg |       4
  3 | https://img3.jpg |       2
  4 | https://img4.jpg |       3
  5 | https://img5.jpg |       3
  6 | https://img6.jpg |       2
  7 | https://img7.jpg |       1
  8 | https://img8.jpg |       1
  9 | https://img9.jpg |       1
(9 è¡Œè®°å½•)
</code></pre>
<h2 id="æŸ¥è¯¢å…³è”æ•°æ®"><a class="header" href="#æŸ¥è¯¢å…³è”æ•°æ®">æŸ¥è¯¢å…³è”æ•°æ®</a></h2>
<p>æˆ‘ä»¬ä½¿ç”¨ <code>user_id</code> å°† <code>photos</code> å’Œ <code>users</code> è”ç³»åœ¨äº†ä¸€èµ·ï¼Œé‚£ä¹ˆè¿™æ ·åšæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦æŸ¥çœ‹æŸä¸ªç”¨æˆ·å‘çš„æ‰€æœ‰å›¾ç‰‡ï¼Œè¿™ä¸ªæƒ…å†µä¸‹ï¼Œå¤–é”®å°±éå¸¸æœ‰ç”¨äº†</p>
<pre><code class="language-sql">select * from photos
  where user_id = 4;
</code></pre>
<p>æˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡º:</p>
<pre><code class="language-text">psqldev=# select * from photos
  where user_id = 4;
 id |       url        | user_id
----+------------------+---------
  1 | https://img1.jpg |       4
  2 | https://img2.jpg |       4
(2 è¡Œè®°å½•)
</code></pre>
<p>å¦‚æœè¦çœ‹æ‰€æœ‰ç…§ç‰‡å’Œç”¨æˆ·çš„å…³ç³»å‘¢ï¼Ÿ</p>
<pre><code class="language-sql">select * from photos
  join users on users.id = photos.user_id;
</code></pre>
<p>å…¶ä¸­ <code>join</code> æ˜¯å°†ä¸¤ä¸ªè¡¨æ ¼åˆå¹¶åœ¨äº†ä¸€èµ·ï¼Œå¹¶ä¸”æ˜¯ä¾æ® <code>user_id</code> ä¸ <code>users.id</code> çš„å¯¹åº”å…³ç³»ï¼Œè¾“å‡ºå¦‚ä¸‹:</p>
<pre><code class="language-text">psqldev=# select * from photos
  join users on users.id = photos.user_id;
 id |       url        | user_id | id | username
----+------------------+---------+----+----------
  9 | https://img9.jpg |       1 |  1 | Alice
  8 | https://img8.jpg |       1 |  1 | Alice
  7 | https://img7.jpg |       1 |  1 | Alice
  6 | https://img6.jpg |       2 |  2 | Bob
  3 | https://img3.jpg |       2 |  2 | Bob
  5 | https://img5.jpg |       3 |  3 | Susan
  4 | https://img4.jpg |       3 |  3 | Susan
  2 | https://img2.jpg |       4 |  4 | Jack
  1 | https://img1.jpg |       4 |  4 | Jack
(9 è¡Œè®°å½•)
</code></pre>
<p>æˆ‘ä»¬ä½¿ç”¨å¤–é”®æ˜¯ä¸ºäº†ä¿è¯ <strong><em>æ•°æ®ä¸€è‡´æ€§</em></strong>ï¼Œä¹Ÿå°±æ˜¯ä¿è¯æˆ‘ä»¬æ’å…¥çš„å›¾ç‰‡æ•°æ®ä¸€å®šèƒ½ä¸æŸä¸ªç”¨æˆ·è”ç³»</p>
<p>å¦‚æœæˆ‘ä»¬æ’å…¥äº†æŸä¸ªä¸å­˜åœ¨çš„ç”¨æˆ· IDï¼Œæ•°æ®åº“å°±ä¼šå‘ç°è¿™ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”æç¤ºæˆ‘ä»¬:</p>
<pre><code class="language-text">psqldev=# insert into photos (
  url
  , user_id
) values
  ('https://img16.jpg', 16);
ERROR:  insert or update on table "photos" violates foreign key constraint "photos_user_id_fkey"
æè¿°:  Key (user_id)=(16) is not present in table "users".
</code></pre>
<p>è¿™é‡Œï¼Œæ•°æ®åº“ç›´æ¥å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ä¸­ï¼Œ<code>16</code> è¿™ä¸ª <code>user_id</code> æ˜¯ä¸å­˜åœ¨çš„</p>
<p>ä¸è¿‡æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦æ’å…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œä½†æ˜¯è¿™ä¸ªå›¾ç‰‡æ˜¯éå¸¸ç‰¹æ®Šçš„ï¼Œä¸å±äºä»»ä½•ä¸€ä¸ªç”¨æˆ·ï¼Œä¾‹å¦‚åº”ç”¨å›¾æ ‡</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>null</code> è¿™ä¸ªç‰¹æ®Šæ•°æ®</p>
<pre><code class="language-sql">insert into photos (
  url
  , user_id
) values
  ('https://app-icon.png', null);
</code></pre>
<p>å¦‚æœæˆ‘ä»¬è¿™ä¸ªæ—¶å€™å†æŸ¥çœ‹æˆ‘ä»¬çš„ <code>photos</code> è¡¨æ ¼æ•°æ®å°±ä¼šå‘ç°ï¼Œ
<code>https://app-icon.png</code> å¯¹åº”çš„ <code>user_id</code> æ˜¯ç©ºç™½ä¸€ç‰‡ï¼Œä¹Ÿå°±æ˜¯ <strong><em>NULL</em></strong></p>
<pre><code class="language-text">psqldev=# select * from photos;
 id |         url          | user_id
----+----------------------+---------
  1 | https://img1.jpg     |       4
  2 | https://img2.jpg     |       4
  3 | https://img3.jpg     |       2
  4 | https://img4.jpg     |       3
  5 | https://img5.jpg     |       3
  6 | https://img6.jpg     |       2
  7 | https://img7.jpg     |       1
  8 | https://img8.jpg     |       1
  9 | https://img9.jpg     |       1
 11 | https://app-icon.png |
(10 è¡Œè®°å½•)
</code></pre>
<hr />
<p>å¥½ï¼Œä»Šå¤©å°±æš‚æ—¶å­¦åˆ°è¿™é‡Œå§ï¼Œåé¢çš„åˆ é™¤ä»€ä¹ˆçš„å°±ä¹‹åå†çœ‹äº†</p>
</main>
                        <nav class="nav-wrapper" aria-label="Page navigation">
                            <a rel="prev" href="../../notes/postgresql/20231024-psql-learn-02.html"
                                class="mobile-nav-chapters previous"
                                title="Previous chapter"
                                aria-label="Previous chapter"
                                aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next prefetch"
                                href="../../notes/typechallenges/index.html"
                                class="mobile-nav-chapters next"
                                title="Next chapter" aria-label="Next chapter"
                                aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                            <div style="clear: both"></div>
                        </nav>
                    </div>
                </div>
                <div class="giscus-comment">
                </div>
                <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../notes/postgresql/20231024-psql-learn-02.html"
                        class="nav-chapters previous" title="Previous chapter"
                        aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next prefetch" href="../../notes/typechallenges/index.html"
                        class="nav-chapters next" title="Next chapter"
                        aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                </nav>
            </div>
            <script>
                window.playground_copyable = true;
            </script>
            <script src="../../elasticlunr.min.js"></script>
            <script src="../../mark.min.js"></script>
            <script src="../../searcher.js"></script>
            <script src="../../clipboard.min.js"></script>
            <script src="../../highlight.js"></script>
            <script src="../../book.js"></script>
            <script src="../../theme/giscus.js"></script>
        </div>
    </body>
</html>
